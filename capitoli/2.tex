% !TEX encoding = UTF-8
% !TEX TS-program = pdflatex
% !TEX root = ../tesi.tex
% !TEX spellcheck = it-IT

%************************************************
\chapter{\texorpdfstring{CTBN}{\ctbn{}}}
\label{cap:ctbn}
%************************************************
\acresetall
In questo capitolo si introducono i concetti fondamentali delle \ac{CTBN}, un framework utile a modellare i processi stocastici relativi a uno spazio degli stati che evolve nel tempo.
Tuttavia, prima di affrontare tale argomento si ritiene indispensabile presentare i suoi fondamenti matematici: le \ac{BN} e i \mprocess{}, trattati entrambi nella \autoref{sec:fondamenti}.

%************************************************
\section{Fondamenti}
\label{sec:fondamenti}
Come accennato, le \acl{CTBN} sviluppano e integrano concetti e idee provenienti da altre teorie afferenti l'area statistica e del machine learning. Al fine di conferire alla discussione sulle \acs{CTBN} un quadro iniziale completo ed esauriente, si presentano quindi gli aspetti di maggior rilievo di tali argomenti.
\begin{description}
\item[\bn{}] \hfill \\
Le \acl{CTBN} utilizzano una rappresentazione strutturata dello spazio degli stati propria della teoria delle \acl{BN}. Ne ereditano perciò gli aspetti chiave (\eg{} indipendenza condizionale) nonché l'insieme delle tecniche algoritmiche efficienti per l'apprendimento e l'inferenza.
\item[\mprocess{}] \hfill \\
Le \acl{CTBN} descrivono la dinamica evolutiva delle variabili casuali da cui sono costituite tramite un \omprocess{} globale, costituito da un insieme di \cmprocess{}.
\end{description} 

\subsection{\bn{}}
\label{sec:bns}
Una \acl{BN} è un modello grafico probabilistico costituito da un \acf{DAG}.\footnote{Un grafo aciclico diretto (anche detto grafo orientato aciclico o digrafo aciclico) è un tipo di grafo che non presenta cicli diretti: comunque si scelga un vertice non è possibile tornare ad esso percorrendo gli archi del grafo.} I nodi di tale grafo rappresentano un insieme di variabili casuali mentre gli archi rappresentano le dipendenze (e le indipendenze) condizionali fra esse. 
Una \acs{BN} rappresenta la distribuzione di probabilità congiunta del suo insieme di variabili casuali tramite la distribuzione di probabilità condizionale di ognuna di essa \eqref{eq:bnchainrule}.
Le \acs{BN} sono quindi modelli grafico probabilistici con cui è possibile modellare in modo probabilistico le relazioni causali dirette fra eventi. Perciò esse risultano molto utili nella rappresentazione e analisi di modelli del mondo reale che coinvolgono incertezza. Sono infatti usate in svariate applicazioni di supporto alle decisioni, bioinformatica, biologia computazionale, data mining, information retrieval e classificazione.

\subsubsection{Rappresentazione}
Di seguito si dà la definizione formale di \acl{BN} e si introducono i loro aspetti basilari.

\begin{definizione}[\acl{BN}]
Una \acl{BN} $\conceptsym{B}$ è una coppia $\conceptsym{B}=(\conceptsym{G},\theta_{\conceptsym{G}})$ costituita da:
\begin{itemize}
    \item $\conceptsym{G}=(\set{V}(\conceptsym{G}),\set{A}(\conceptsym{G}))$, un \acl{DAG} dove:
    \begin{itemize}
        \item $\set{V}(\conceptsym{G})=\{\setel{V_1}, \dotsc, \setel{V_n}\}$ è l'insieme dei nodi, ognuno dei quali è associato con una \acf{CPD}\footnote{Nel caso di variabili causali discrete, le \acs{CPD} sono rappresentabili come delle tabelle che contengono i valori di probabilità di un nodo in funzione di tutte le possibili configurazioni dei nodi genitori (cioè l'insieme dei nodi da cui parte un arco che punta al nodo di interesse).}
        \item ogni nodo è condizionalmente indipendente (\ref{defn:ic}) dai suoi non--discendenti dati i suoi nodi genitori
        \item $\set{A}(\conceptsym{G})\subseteq\set{V}(\conceptsym{G})\times\set{V}(\conceptsym{G})$ è l'insieme degli archi fra i nodi $\set{V}(\conceptsym{G})$
    \end{itemize}
    \item $\theta_{\conceptsym{G}}$, insieme delle \acs{CPD} dei nodi che specifica $\set{P}_{\conceptsym{B}}$, la distribuzione di probabilità congiunta delle variabili casuali $\set{X}_{\set{V}(\conceptsym{G})}$ a cui corrispondono i nodi $\set{V}(\conceptsym{G})$.
\end{itemize}
\end{definizione}

La \acs{CPD} di ogni variabile casuale $\setel{X_i}\in\set{X}_{\set{V}(\conceptsym{G})}$ esprime i suoi valori di probabilità in funzione dei valori assunti da $pa(\setel{X_i})$, notazione con cui denotiamo l'\emph{insieme dei nodi genitori} per ogni nodo o variabile casuale.

Mentre un arco da un nodo genitore verso un nodo figlio di $\conceptsym{G}$ rappresenta una dipendenza condizionale fra le corrispettive variabili casuali, i nodi non connessi, invece, rappresentano variabili casuali indipendenti dagli altri nodi (per quanto riguarda il concetto di \emph{indipendenza condizionale} si rimanda invece a \ref{defn:ic}).

Prima di procedere con la discussione si introduce la Chain Rule, regola molto utile nel caso delle \acs{BN}.

\begin{teorema}[Chain Rule]
Dato un insieme di variabili casuali e una distribuzione di probabilità congiunta definita su di esse è possibile calcolare qualsiasi elemento di tale distribuzione tramite le distribuzioni di probabilità condizionale delle variabili casuali \cite{Russel2003}.
\end{teorema}

Perciò, dato un insieme di variabili casuali $\setel{A_1},\dotsc,\setel{A_n}$ è possibile calcolare il valore di tale membro della distribuzione di probabilità congiunta applicando la definizione di probabilità condizionale:
\[
\set{P}(\setel{A_1},\dotsc,\setel{A_n})=\set{P}(\setel{A_n}|\setel{A_{n-1}},\dotsc,\setel{A_1})\cdot\set{P}(\setel{A_{n-1}},\dotsc,\setel{A_1})
\]
Ripetendo tale processo per ogni termine finale si ottiene:
\begin{equation}
\label{eq:chainrule}
\set{P}(\bigcap_{k=1}^{n}\setel{A_k})=\prod_{k=1}^{n}\set{P}(\setel{A_k}|\bigcap_{j=1}^{k-1}\setel{A_j})
\end{equation}

Applicando la \eqref{eq:chainrule} alle \acl{BN} diciamo che la distribuzione di probabilità congiunta $\set{P}_{\conceptsym{B}}$ si \emph{fattorizza} rispetto al grafo $\conceptsym{G}$ se è possibile scrivere:
\begin{equation}
\label{eq:bnchainrule}
\set{P}_{\conceptsym{B}}(\setel{X_1}, \dotsc, \setel{X_n})=\prod_{i=1}^{n}\set{P}(\setel{X_i}|pa(\setel{X_i}))
\end{equation}
L'equazione \eqref{eq:bnchainrule} esprime quindi la \emph{proprietà di fattorizzazione} della distribuzione congiunta del modello grafico.

\begin{definizione}[Indipendenza condizionale]\label{defn:ic}
di qui collegarsi, mettendo link, alla proprietà/assunzione di Markov
\end{definizione} 

local markov property?
bayes rule?

\subsubsection{Apprendimento}

regola del prodotto -> th di bayes
significato th di bayes: apprendimento dall'esperienza

\subsubsection{Inferenza}

\subsection{\mprocess{}}
\label{sec:mps}

\begin{definizione}[Assunzione di Markov]
\end{definizione} 

\begin{definizione}[\upcase\omprocess{}]
\end{definizione} 

\begin{definizione}[Matrice di intensità]
\end{definizione} 

\begin{definizione}[\upcase\cmprocess{}]
\end{definizione} 

\begin{definizione}[Matrice di intensità condizionata]
\end{definizione} 

%************************************************
\section{Rappresentazione}
\label{sec:rappresentazione}

Una \acl{CTBN} è un modello grafico in cui ogni nodo è associato con una variabile casuale i cui stati evolvono nel tempo continuo. Si assume perciò che tali dinamiche evolutive siano governate e dipendano dal valore che gli stati dei nodi padre assumono \cite{Stella2012}.
Una \acs{CTBN} è composta principalmente da due componenti:
\begin{itemize}
    \item una distribuzione di probabilità iniziale
    \item le dinamiche che regolano l'evoluzione nel tempo continuo della distribuzione di probabilità
\end{itemize}
Più formalmente si definisce:
\begin{definizione}[\acl{CTBN}]
Dato un insieme $\set{X}$ di variabili casuali $\setel{X_1}, \setel{X_2}, \dotsc, \setel{X_N}$ dove ogni $\setel{X_n}$ ha uno spazio degli stati finito $val(\setel{X_N})=\{ \vectel{x_1}, \dotsc, \vectel{x_J} \}$, una \acs{CTBN} $\conceptsym{N}$ su $\set{X}$ consiste di:
\begin{itemize}
    \item una distribuzione di probabilità iniziale $\priorsign{\set{X}}$ specificata come una \bn{} $\conceptsym{B}$ su $\set{X}$
    \item un modello di transizione continuo, specificato da:
    \begin{itemize}
        \item un grafo $\conceptsym{G}$, orientato e non necessariamente aciclico, composto dai nodi $\setel{X_1}, \setel{X_2}, \dotsc, \setel{X_N}$, ognuno dei quali possiede un insieme di genitori (possibilmente vuoto) denotato da $pa(\setel{X_n})$
        \item una matrice di intensità condizionale $\cimsign{\setel{X_n}}$ per ogni nodo $\setel{X_n} \in \set{X}$.
    \end{itemize}
\end{itemize}
\end{definizione}
\begin{nota}
Si noti che, diversamente dalle \acl{BN}, nelle \acl{CTBN} gli archi fra i nodi rappresentano le relazioni temporali fra essi. Tali relazioni codificano le dinamiche evolutive dei nodi, ognuna delle quali è espressa condizionatamente alla dinamica evolutiva degli stati dei suoi nodi genitori. Per tale motivo è possibile che la componente $\conceptsym{G}$ del modello di transizione continuo contenga dei cicli. Tra l'altro, come vedremo nel prosieguo, la mancanza di tale vincolo di aciclicità porta a notevoli vantaggi computazionali relativamente all'apprendimento della struttura di una \acs{CTBN} dai dati. 
\end{nota}

%************************************************
\section{Apprendimento}
\label{sec:apprendimento}

%************************************************
\section{Inferenza}
\label{sec:inferenza}


% TODO: apprendimento strutturale?
% TODO: inserire immagini esemplificative delle ctbn
